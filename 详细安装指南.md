# 详细安装指南：解决 PyQt5 模块未找到的问题

如果您在运行课程表软件时遇到了 `ModuleNotFoundError: No module named 'PyQt5'` 错误，这意味着您的系统上尚未安装 PyQt5 库。请按照以下步骤尝试解决这个问题：

## 方法一：使用批处理文件安装（推荐）

1. 右键点击 `install_dependencies.bat` 文件
2. 选择 "以管理员身份运行"
3. 等待安装过程完成

这个批处理文件会尝试使用 pip 安装 PyQt5 库。

## 方法二：手动使用命令行安装

如果批处理文件安装失败，请尝试以下手动安装方法：

1. 按下 `Win + R` 键打开运行对话框
2. 输入 `cmd` 并按下 `Enter` 键打开命令提示符
3. 在命令提示符中输入以下命令之一，然后按 `Enter` 键：

### 基本安装命令

```cmd
pip install PyQt5
```

### 如果基本命令失败，尝试以下替代命令：

```cmd
python -m pip install PyQt5
```

```cmd
py -m pip install PyQt5
```

```cmd
pip3 install PyQt5
```

```cmd
python3 -m pip install PyQt5
```

### 如果遇到权限问题，尝试使用管理员权限：

1. 在开始菜单中找到 "命令提示符"
2. 右键点击并选择 "以管理员身份运行"
3. 然后在管理员命令提示符中输入上述安装命令之一

### 如果遇到网络问题，尝试使用国内镜像源：

```cmd
pip install PyQt5 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

```cmd
python -m pip install PyQt5 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

## 方法三：检查 Python 是否正确安装

如果上述方法都失败了，可能是因为 Python 没有正确安装或者没有添加到系统路径中：

1. 检查 Python 是否已安装：
   - 在命令提示符中输入 `python --version` 或 `py --version`
   - 如果显示 Python 版本号，说明 Python 已安装
   - 如果显示 "不是内部或外部命令"，说明 Python 未安装或未添加到系统路径

2. 如果 Python 未安装，请先从官网下载并安装：
   - 访问 https://www.python.org/downloads/
   - 下载最新版本的 Python 安装程序
   - 运行安装程序，务必勾选 "Add Python to PATH" 选项

## 方法四：创建虚拟环境安装

如果您仍然遇到问题，可以尝试在虚拟环境中安装：

1. 在命令提示符中，导航到课程表软件所在文件夹：
   ```cmd
   cd c:\Users\xsj\Desktop\classtable
   ```

2. 创建虚拟环境：
   ```cmd
   python -m venv venv
   ```

3. 激活虚拟环境：
   ```cmd
   venv\Scripts\activate
   ```

4. 在虚拟环境中安装 PyQt5：
   ```cmd
   pip install PyQt5
   ```

5. 在虚拟环境中运行程序：
   ```cmd
   python classtable.py
   ```

## 常见问题排查

### 1. pip 不是内部或外部命令

- 这意味着 pip 没有添加到系统路径中
- 尝试使用 `python -m pip` 代替 `pip`
- 或者检查 Python 安装时是否勾选了 "Add Python to PATH" 选项

### 2. 安装过程中出现错误

- 确保您的网络连接正常
- 尝试使用国内镜像源
- 确保您有足够的磁盘空间
- 尝试关闭杀毒软件后再安装

### 3. 安装成功但仍然提示找不到模块

- 可能是因为您安装的 Python 版本与运行程序时使用的 Python 版本不一致
- 检查运行程序时使用的 Python 版本
- 尝试使用 `python -m pip install PyQt5` 确保安装到正确的 Python 环境中

## 联系我们

如果您尝试了上述所有方法仍然无法解决问题，请寻求技术支持或在网上搜索更多关于 PyQt5 安装的解决方案。

---

祝您安装顺利！